CREATE TABLE user (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(20) NOT NULL UNIQUE,
  win_count BIGINT NOT NULL DEFAULT 0,
  lose_count BIGINT NOT NULL DEFAULT 0,
  created_time DATETIME DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE game (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  white_id BIGINT NOT NULL,
  black_id BIGINT NOT NULL,
  turn VARCHAR(10) NOT NULL DEFAULT "white",
  is_finished TINYINT(1) NOT NULL DEFAULT 0,
  created_time DATETIME DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY(white_id) REFERENCES user(id) ON UPDATE CASCADE ON DELETE RESTRICT,
  FOREIGN KEY(black_id) REFERENCES user(id) ON UPDATE CASCADE ON DELETE RESTRICT
);

CREATE TABLE piece (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  game_id BIGINT NOT NULL,
  piece_type VARCHAR(1) NOT NULL,
  team VARCHAR(10) NOT NULL,
  x INT NOT NULL,
  y INT NOT NULL,
  FOREIGN KEY(game_id) REFERENCES game(id) ON UPDATE CASCADE ON DELETE RESTRICT
);
